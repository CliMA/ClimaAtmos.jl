<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Gravity wave · ClimaAtmos.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">ClimaAtmos.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../installation_instructions/">Installation instructions</a></li><li><a class="tocitem" href="../contributor_guide/">Contributor Guide</a></li><li><a class="tocitem" href="../equations/">Equations</a></li><li><a class="tocitem" href="../edmf_equations/">EDMF Equations</a></li><li class="is-active"><a class="tocitem" href>Gravity wave</a><ul class="internal"><li><a class="tocitem" href="#Non-orographic-gravity-wave"><span>Non-orographic gravity wave</span></a></li><li><a class="tocitem" href="#Orographic-gravity-wave"><span>Orographic gravity wave</span></a></li></ul></li><li><a class="tocitem" href="../repl_scripts/">REPL scripts</a></li><li><a class="tocitem" href="../cl_args/">Command line arguments</a></li><li><a class="tocitem" href="../api/">API</a></li><li><a class="tocitem" href="../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Gravity wave</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Gravity wave</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/CliMA/ClimaAtmos.jl/blob/main/docs/src/gravity_wave.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Gravity-wave-parameterization"><a class="docs-heading-anchor" href="#Gravity-wave-parameterization">Gravity wave parameterization</a><a id="Gravity-wave-parameterization-1"></a><a class="docs-heading-anchor-permalink" href="#Gravity-wave-parameterization" title="Permalink"></a></h1><p>Gravity waves have a great impact on the atmospheric circulation. They are usually generated from topography or convection, propagate upward and alter temperature and winds in the middle atmosphere, and influence tropospheric circulation through downward control. The horizontal wavelength for gravity waves ranges from several kilometers to hundreds of kilometers, which is smaller than typical GCM resolution and needs to be parameterized.</p><p>The gravity wave drag on the wind velocities (<span>$\overline{\vec{v}}=(u,v)$</span>) are </p><p class="math-container">\[\frac{\partial \overline{\vec{v}}}{ \partial t} = ... - \underbrace{\frac{\partial \overline{\vec{v}&#39;w&#39;}}{\partial z}\Big|_{GW} }_{\vec{X}} \]</p><p>with <span>$\vec{X} = (X_\lambda, X_\phi)$</span> representing the subgrid scale zonal and meridional components of the gravity wave drag and is calculated with the parameterization. </p><h2 id="Non-orographic-gravity-wave"><a class="docs-heading-anchor" href="#Non-orographic-gravity-wave">Non-orographic gravity wave</a><a id="Non-orographic-gravity-wave-1"></a><a class="docs-heading-anchor-permalink" href="#Non-orographic-gravity-wave" title="Permalink"></a></h2><p>The non-orographic gravity wave drag parameterization follows the spectra methods described in <a href="../references/#alexander1999">Joan M Alexander, Timothy J Dunkerton (1999)</a>. The following assumptions are made for this parameterization to work:</p><ul><li>The wave spectrum consists of independent monochromatic waves, and wave-wave interaction is neglected when propagation and instability is computed.</li><li>The gravity wave propagates vertically and conservatively to the breaking level and deposits all momentum flux into that level, as opposed to the method using saturation profile described in <a href="../references/#lindzen1981">Richard S Lindzen (1981)</a>.</li><li>The wave breaking criterion is derived in a hydrostatic, non-rotating frame. Including nonhydrostatic and rotation is proved to have negligible impacts.</li><li>The gravity wave is intermittent and the intermittency is computed as the ratio of the total long-term average source to the integral of the source momentum flux spectrum.</li></ul><h3 id="Spetrum-of-the-momentum-flux-sources"><a class="docs-heading-anchor" href="#Spetrum-of-the-momentum-flux-sources">Spetrum of the momentum flux sources</a><a id="Spetrum-of-the-momentum-flux-sources-1"></a><a class="docs-heading-anchor-permalink" href="#Spetrum-of-the-momentum-flux-sources" title="Permalink"></a></h3><p>The source spectrum with respect to phase speed is prescribed in Eq. (17) in <a href="../references/#alexander1999">Joan M Alexander, Timothy J Dunkerton (1999)</a>. We adapt the equation so that the spectrum writes as a combination of a wide and a narrow band as</p><p class="math-container">\[B_0(c) = \frac{F_{S0}(c)}{\rho_0} = sgn(c-u_0) \left( Bm\_w \exp\left[ -\left( \frac{c-c_0}{c_{w\_w}} \right) \ln{2} \right] + Bm\_n \exp\left[ -\left( \frac{c-c_0}{c_{w\_n}} \right) \ln{2} \right] \right)\]</p><p>where the subscript <span>$0$</span> denotes values at the source level. <span>$c_0$</span> is the phase speed with the maximum flux magnitude <span>$Bm$</span>. <span>$c_w$</span> is the half-width at half-maximum of the Gaussian.  <span>$\_w$</span> and <span>$\_n$</span> represent the wide and narrow bands of the spectra.</p><h3 id="Upward-propagation-and-wave-breaking"><a class="docs-heading-anchor" href="#Upward-propagation-and-wave-breaking">Upward propagation and wave breaking</a><a id="Upward-propagation-and-wave-breaking-1"></a><a class="docs-heading-anchor-permalink" href="#Upward-propagation-and-wave-breaking" title="Permalink"></a></h3><p>Waves that are reflected will be removed from the spectrum. A wave that breaks at a level above the source will deposit all its momentum flux into that level and be removed from the spectrum.</p><p>The reflection frequency is defined as</p><p class="math-container">\[\omega_r(z) = (\frac{N(z)^2 k^2}{k^2+\alpha^2})^{1/2}\]</p><p>where <span>$N(z)$</span> is the buoyancy frequency, <span>$k$</span> is the horizontal wavenumber that corresponds to a wavelength of 300 km, <span>$\alpha = 1/H$</span> where <span>$H$</span> is the scale height. <span>$\omega_r(z)$</span> is used to determine for each monochromatic wave in the spectrum, whether it will be reflected at height <span>$z$</span>.</p><p>The instability condition is defined as</p><p class="math-container">\[Q(z,c) = \frac{\rho_0}{\rho(z)} \frac{2N(z)B_0(c)}{k[c-u(z)]^3}\]</p><p><span>$Q(z,c)$</span> is used to determine whether the monochromatic wave of phase speed <span>$c$</span> gets unstable at height <span>$z$</span>. </p><ul><li><p>At the source level</p><ul><li>if <span>$|\omega|=k|c-u_0| \geq \omega_r$</span>, this wave would have undergone internal reflection somewhere below and is removed from the spectrum;</li><li>if <span>$Q(z_0, c) \geq 1$</span>, it is also removed because it is not stable at the source level.</li></ul></li><li><p>At the levels above <span>$(z_n&gt;z_0)$</span>, <span>$|\omega(z_n)|=k|c-u(z_n)| \geq \omega_r(z_n)$</span> is removed from the spectrum. In the remaining speed, <span>$Q(z_n,c) \geq 1$</span> are breaking between level <span>$z_{n-1}$</span> and <span>$z_n$</span>, and this portion of momentum flux is all deposited between <span>$z_{n-1}$</span> and <span>$z_n$</span>, which yields</p><p class="math-container">\[X(z_{n-1/2}) = \frac{\epsilon \rho_0}{\rho(z_{n-1/2)}}\Sigma_j (B_0)j.\]</p><p>where <span>$\epsilon=F_{S0}/\rho_0/\Sigma B_0$</span> is the wave intermittency. In computing the intermittency, <span>$F_{S0}$</span> is the time average total momentum flux and is prescribed as latitude dependent properties.  And we get </p><p class="math-container">\[X(z_{n-1}) = 0.5*\left[X(z_{n-3/2}) +X(z_{n-1/2}) \right].\]</p></li></ul><p>By applying the above parameterization on zonal and meridional winds, the forcing for the physical wind velocity is computed. We further transform them onto the Covariant vectors and that will be the tendencied added onto the momentum equation.</p><h2 id="Orographic-gravity-wave"><a class="docs-heading-anchor" href="#Orographic-gravity-wave">Orographic gravity wave</a><a id="Orographic-gravity-wave-1"></a><a class="docs-heading-anchor-permalink" href="#Orographic-gravity-wave" title="Permalink"></a></h2></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../edmf_equations/">« EDMF Equations</a><a class="docs-footer-nextpage" href="../repl_scripts/">REPL scripts »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Tuesday 16 May 2023 18:58">Tuesday 16 May 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
