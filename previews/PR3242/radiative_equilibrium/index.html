<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Radiative Equilibrium · ClimaAtmos.jl</title><meta name="title" content="Radiative Equilibrium · ClimaAtmos.jl"/><meta property="og:title" content="Radiative Equilibrium · ClimaAtmos.jl"/><meta property="twitter:title" content="Radiative Equilibrium · ClimaAtmos.jl"/><meta name="description" content="Documentation for ClimaAtmos.jl."/><meta property="og:description" content="Documentation for ClimaAtmos.jl."/><meta property="twitter:description" content="Documentation for ClimaAtmos.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="ClimaAtmos.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">ClimaAtmos.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../installation_instructions/">Installation instructions</a></li><li><a class="tocitem" href="../contributor_guide/">Contributor Guide</a></li><li><a class="tocitem" href="../equations/">Equations</a></li><li><a class="tocitem" href="../edmf_equations/">EDMF Equations</a></li><li><a class="tocitem" href="../diagnostics/">Diagnostics</a></li><li><a class="tocitem" href="../available_diagnostics/">Available Diagnostics</a></li><li><a class="tocitem" href="../diagnostic_edmf_equations/">Diagnostic EDMF Equations</a></li><li><a class="tocitem" href="../gravity_wave/">Gravity Wave Drag Parameterizations</a></li><li><a class="tocitem" href="../surface_albedo/">Ocean Surface Albedo Parameterization</a></li><li class="is-active"><a class="tocitem" href>Radiative Equilibrium</a><ul class="internal"><li class="toplevel"><a class="tocitem" href="#Radiative-Equilibrium"><span>Radiative Equilibrium</span></a></li><li class="toplevel"><a class="tocitem" href="#Greenhouse-Gas-Concentrations"><span>Greenhouse Gas Concentrations</span></a></li><li class="toplevel"><a class="tocitem" href="#Data-extraction-in-Julia"><span>Data extraction in Julia</span></a></li></ul></li><li><a class="tocitem" href="../repl_scripts/">REPL scripts</a></li><li><a class="tocitem" href="../config/">Configuration</a></li><li><a class="tocitem" href="../parameters/">Parameters</a></li><li><a class="tocitem" href="../longruns/">Longruns</a></li><li><a class="tocitem" href="../api/">API</a></li><li><a class="tocitem" href="../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Radiative Equilibrium</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Radiative Equilibrium</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/CliMA/ClimaAtmos.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/CliMA/ClimaAtmos.jl/blob/main/docs/src/radiative_equilibrium.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Radiative-Equilibrium-Example"><a class="docs-heading-anchor" href="#Radiative-Equilibrium-Example">Radiative Equilibrium Example</a><a id="Radiative-Equilibrium-Example-1"></a><a class="docs-heading-anchor-permalink" href="#Radiative-Equilibrium-Example" title="Permalink"></a></h1><p>A suite of concrete examples are provided here as a guidance for running single column Radiative Equilibrium.  </p><h1 id="Radiative-Equilibrium"><a class="docs-heading-anchor" href="#Radiative-Equilibrium">Radiative Equilibrium</a><a id="Radiative-Equilibrium-1"></a><a class="docs-heading-anchor-permalink" href="#Radiative-Equilibrium" title="Permalink"></a></h1><p>Radiative equilibrium is a useful framework for analyzing atmospheric temperature profiles with different atmosphere conditions. In radiative equilibrium, we only consider heat exchange from radiation. In this example, we only match the total energy, and assume a fixed relative humidity to get specific humidity.</p><p>To run a radiative equilibrium simulation, create a yaml file (or use a default one) and run the following commands in your terminal (after instantiating the necessary packages):</p><p>The yaml file should look something like this: <code>mysim.yml</code></p><pre><code class="nohighlight hljs">rad: &quot;clearsky&quot; 
idealized_h2o: true 
hyperdiff: false 
config: &quot;column&quot; 
initial_condition: &quot;IsothermalProfile&quot; 
z_max: 70000
z_elem: 70 
dz_bottom: 100 
dz_top: 10000 
t_end: &quot;654days&quot; 
dt: &quot;3hours&quot; 
dt_save_to_sol: &quot;30hours&quot; 
dt_save_state_to_disk: &quot;100days&quot; 
prognostic_surface: true
job_id: &quot;single_column_radiative_equilibrium_clearsky_prognostic_surface_temp&quot;</code></pre><p>Then run the simulation with the following command:</p><pre><code class="nohighlight hljs">julia --project=examples examples/driver.jl --config_file path to mysim.yml</code></pre><p>The configuration in the yaml file above can be changed to adjust to the kind of simulation desired. Options such as t_end can be increased to the desired simulation time. Other arguments such as radiation type can be changed based on the options in <code>default_config.yml</code>.</p><p>After a simulation is ran the output files should be available in the output folder, where hdf5 files store all the simulation&#39;s data, and two mp4s should be produced with a vertical temperature profile and a vertical wind profile which change over time. If you want to quickly access data from the final day of the simulation simply add a -i to the command line input, like so:</p><pre><code class="nohighlight hljs">julia -i --project=examples examples/driver.jl --config_file filepath</code></pre><p>This will bring you into a julia environment where the current state of the simulation can be accessed. Run propertynames(Y) and propertynames(p) to see accessible values, some examples:</p><p><img src="../assets/sample_-i_outputs.png" alt/></p><p>Here is a typical vertical temperature profile on the final day of a simulation (the dot is surface temperature):</p><p><img src="../assets/example_temp_profile.png" alt/></p><p>Note: The surface temperature must also converge before the simulation reaches radiative equilibrium, here is a typical convergence of surface temperature plot:</p><p><img src="../assets/surface_temp_convergence.png" alt/></p><h1 id="Greenhouse-Gas-Concentrations"><a class="docs-heading-anchor" href="#Greenhouse-Gas-Concentrations">Greenhouse Gas Concentrations</a><a id="Greenhouse-Gas-Concentrations-1"></a><a class="docs-heading-anchor-permalink" href="#Greenhouse-Gas-Concentrations" title="Permalink"></a></h1><p>In <code>radiation.jl</code> one can change the concentrations of greenhouse gases in order to test their effects on the atmospheric temperature profile.</p><p>To change the ozone concentration multiply the following variable by the desired coefficient:</p><pre><code class="nohighlight hljs">center_volume_mixing_ratio_o3 =
                Fields.field2array(@. FT(pressure2ozone(default_cache.ᶜp))) * desired_coefficient</code></pre><p>Here are the equilibrium temperature profiles under different ozone concentrations:</p><p><img src="../assets/O3_temp_profile.png" alt/> <img src="../assets/O3_temp_difference.png" alt/></p><p>To change the CO2 concentration, multiply the volume mixing ratio by the desired coefficient:</p><pre><code class="nohighlight hljs">volume_mixing_ratio_co2 = input_vmr(&quot;carbon_dioxide_GM&quot;) * desired_coefficient</code></pre><p>Here are the equilibrium temperature profiles under different CO2 concentrations:</p><p><img src="../assets/CO2_temp_profile.png" alt/> <img src="../assets/CO2_temp_difference.png" alt/></p><p>Similarly, one can change the concentration of any other gases in the atmosphere</p><h1 id="Data-extraction-in-Julia"><a class="docs-heading-anchor" href="#Data-extraction-in-Julia">Data extraction in Julia</a><a id="Data-extraction-in-Julia-1"></a><a class="docs-heading-anchor-permalink" href="#Data-extraction-in-Julia" title="Permalink"></a></h1><p>To access the data from hdf5 files one can use the following code to create a var <code>diagnostics</code> which stores values from a hdf5 file path:</p><pre><code class="nohighlight hljs">import ClimaAtmos: time_from_filename
import ClimaCore: Geometry, Spaces, Fields, InputOutput
import ClimaComms
import CairoMakie: Makie
import Statistics: mean

function read_hdf5_file(file_path)
    reader =
        InputOutput.HDF5Reader(file_path, ClimaComms.SingletonCommsContext())
    diagnostics = InputOutput.read_field(reader, &quot;diagnostics&quot;)
    close(reader)
    return time_from_filename(file_path), diagnostics
end

time, diagnostics = read_hdf5_file(&quot;sample/file/path&quot;)</code></pre><p><code>diagnostics</code> will contain the values from the state of the simulation at a given time. <code>propertynames(diagnostics)</code> can be useful for finding accessible values. For example, <code>diagnostics.sfc_temperature</code> contains the surface temperature at a given time in the simulation.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../surface_albedo/">« Ocean Surface Albedo Parameterization</a><a class="docs-footer-nextpage" href="../repl_scripts/">REPL scripts »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.5.0 on <span class="colophon-date" title="Tuesday 20 August 2024 14:40">Tuesday 20 August 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
