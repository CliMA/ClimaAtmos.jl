<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Single Column Model · ClimaAtmos.jl</title><meta name="title" content="Single Column Model · ClimaAtmos.jl"/><meta property="og:title" content="Single Column Model · ClimaAtmos.jl"/><meta property="twitter:title" content="Single Column Model · ClimaAtmos.jl"/><meta name="description" content="Documentation for ClimaAtmos.jl."/><meta property="og:description" content="Documentation for ClimaAtmos.jl."/><meta property="twitter:description" content="Documentation for ClimaAtmos.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="ClimaAtmos.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">ClimaAtmos.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../getting_started/">Getting Started</a></li><li><a class="tocitem" href="../contributor_guide/">Contributor Guide</a></li><li><a class="tocitem" href="../equations/">Equations</a></li><li><a class="tocitem" href="../microphysics/">Microphysics</a></li><li><a class="tocitem" href="../edmf_equations/">EDMF Equations</a></li><li><a class="tocitem" href="../diagnostics/">Diagnostics</a></li><li><a class="tocitem" href="../available_diagnostics/">Available Diagnostics</a></li><li><a class="tocitem" href="../diagnostic_edmf_equations/">Diagnostic EDMF Equations</a></li><li><a class="tocitem" href="../gravity_wave/">Gravity Wave Drag Parameterizations</a></li><li><a class="tocitem" href="../surface_albedo/">Ocean Surface Albedo Parameterization</a></li><li><a class="tocitem" href="../topography/">Topography Representation</a></li><li><a class="tocitem" href="../tracers/">Tracers</a></li><li><a class="tocitem" href="../implicit_solver/">Implicit Solver</a></li><li><a class="tocitem" href="../radiative_equilibrium/">Radiative Equilibrium</a></li><li class="is-active"><a class="tocitem" href>Single Column Model</a><ul class="internal"><li><a class="tocitem" href="#Externally-Driven-Single-Column-Models"><span>Externally-Driven Single Column Models</span></a></li></ul></li><li><a class="tocitem" href="../restarts/">Restarts and checkpoints</a></li><li><a class="tocitem" href="../repl_scripts/">REPL scripts</a></li><li><a class="tocitem" href="../config/">Configuration</a></li><li><a class="tocitem" href="../parameters/">Parameters</a></li><li><a class="tocitem" href="../longruns/">Longruns</a></li><li><a class="tocitem" href="../itime/">The time type</a></li><li><a class="tocitem" href="../api/">API</a></li><li><a class="tocitem" href="../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Single Column Model</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Single Column Model</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/CliMA/ClimaAtmos.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/CliMA/ClimaAtmos.jl/blob/main/docs/src/single_column_prospect.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Single-Column-Models"><a class="docs-heading-anchor" href="#Single-Column-Models">Single Column Models</a><a id="Single-Column-Models-1"></a><a class="docs-heading-anchor-permalink" href="#Single-Column-Models" title="Permalink"></a></h1><p><code>ClimaAtmos.jl</code> supports several canonical test cases that are run in a single column model designed to verify how well PROSPCT (EDMF) is able to reproduce each of the convective schemes. These cases include variants of <code>bomex</code>, <code>dycoms</code>, <code>rico</code>, <code>soares</code>, <code>gabls</code>, <code>gate</code>,and <code>trmm</code> and can be found in the <code>config/model_configs</code> directory. The purpose of each simulation is summarized in the following table:</p><table><tr><th style="text-align: right">Abbreviation</th><th style="text-align: right">Long Name</th><th style="text-align: right">Cloud Regime</th><th style="text-align: right">Reference</th></tr><tr><td style="text-align: right">BOMEX</td><td style="text-align: right">Barbados Oceanographic and Meteorological Experiment</td><td style="text-align: right">Marine Cumulus</td><td style="text-align: right"><a href="https://doi.org/10.1175/1520-0469(2003)60&lt;1201:ALESIS&gt;2.0.CO;2">Siebesma et al. (2003)</a></td></tr><tr><td style="text-align: right">DYCOMS</td><td style="text-align: right">Dynamics and Chemistry of Marine Stratocumulus</td><td style="text-align: right">Marine Stratocumulus</td><td style="text-align: right"><a href="https://doi.org/10.1175/MWR2930.1">Stevens et al. (2005)</a>, <a href="https://doi.org/10.1175/2008MWR2582.1">Ackerman et al. (2009)</a></td></tr><tr><td style="text-align: right">RICO</td><td style="text-align: right">Rain in Cumulus over the Ocean</td><td style="text-align: right">Rainy Cumulus</td><td style="text-align: right"><a href="https://doi.org/10.1175/BAMS-88-12-1912">Rauber et al. (2007)</a></td></tr><tr><td style="text-align: right">SOARES</td><td style="text-align: right">Shallow Cumulus Convection</td><td style="text-align: right">Shallow Cumulus</td><td style="text-align: right"><a href="https://doi.org/10.1256/qj.03.223">Soares et al. (2004)</a></td></tr><tr><td style="text-align: right">GABLS</td><td style="text-align: right">GEWEX Atmospheric Boundary Layer Study</td><td style="text-align: right">Dry Convective Boundary Layer</td><td style="text-align: right"><a href="https://doi.org/10.1175/1520-0469(2000)057&lt;1052:ALESSO&gt;2.0.CO;2">Kosović &amp; Curry (2000)</a></td></tr><tr><td style="text-align: right">TRMM</td><td style="text-align: right">Tropical Rainfall Measuring Mission</td><td style="text-align: right">Deep Convection</td><td style="text-align: right"><a href="https://doi.org/10.1256/qj.04.147">Grabowski et al. (2006)</a></td></tr><tr><td style="text-align: right">ARM_SGP</td><td style="text-align: right">Atmospheric Radiation Measurement Southern Great Plains</td><td style="text-align: right">Continental Shallow Cumulus</td><td style="text-align: right"><a href="https://doi.org/10.1256/qj.01.202">Brown et al. (2002)</a></td></tr><tr><td style="text-align: right">LifeCycle</td><td style="text-align: right">Life Cycle of Shallow Cumulus</td><td style="text-align: right">Shallow Cumulus Life Cycle</td><td style="text-align: right"><a href="https://doi.org/10.1002/2017MS001162">Tan et al. (2018)</a></td></tr><tr><td style="text-align: right">GATE_III</td><td style="text-align: right">GARP Atlantic Tropical Experiment</td><td style="text-align: right">Tropical Deep Convection</td><td style="text-align: right"><a href="https://doi.org/10.3894/JAMES.2009.1.15">Khairoutdinov et al. (2009)</a></td></tr></table><p>For example, to run the BOMEX test case execute the following:</p><pre><code class="language-bash hljs">julia --project=.buildkite .buildkite/ci_driver.jl --config_file config/model_configs/prognostic_edmfx_bomex_column.yml --job_id bomex</code></pre><p>It may also be helpful to run in interactive mode to be able to examine the simulation object, debug, and develop the code further. To enter debug mode run <code>julia --project=.buildkite</code> and then in the REPL run:</p><pre><code class="language-julia hljs">using Revise # if you are developing ClimaAtmos
import ClimaAtmos as CA

# get the configuration arguments
simulation = CA.AtmosSimulation(&quot;config/model_configs/prognostic_edmfx_bomex_column.yml&quot;)
sol_res = CA.solve_atmos!(simulation) # run the simulation</code></pre><h2 id="Externally-Driven-Single-Column-Models"><a class="docs-heading-anchor" href="#Externally-Driven-Single-Column-Models">Externally-Driven Single Column Models</a><a id="Externally-Driven-Single-Column-Models-1"></a><a class="docs-heading-anchor-permalink" href="#Externally-Driven-Single-Column-Models" title="Permalink"></a></h2><p>Currently three versions of the externally driven single column model, <code>GCM</code> driven, <code>ReanalysisTimeVarying</code> driven, and <code>ReanalysisMonthlyAveragedDiurnal</code> driven are supported in <code>ClimaAtmos.jl</code>. Externally-driven means that the model is initialized and forced with data coming from a different simulation. This differs from setups like, for example, BOMEX or SOARES which have steady forcing and low domain tops (~4km) or functional forcing, respectively. They have been developed specifically for the purpose of model calibration by recreating statistics that are close to either LES, for the <code>GCM</code> driven case only, or to observations.</p><h3 id="GCM-Driven-Case"><a class="docs-heading-anchor" href="#GCM-Driven-Case">GCM-Driven Case</a><a id="GCM-Driven-Case-1"></a><a class="docs-heading-anchor-permalink" href="#GCM-Driven-Case" title="Permalink"></a></h3><p>For the <code>GCM</code> driven case we can run the experiment using the config file <code>config/model_configs/prognostic_edmfx_gcmdriven_column.yml</code> by running:</p><pre><code class="language-bash hljs">julia --project=.buildkite .buildkite/ci_driver.jl --config_file config/model_configs/prognostic_edmfx_gcmdriven_column.yml --job_id gcm_driven_scm</code></pre><p>In the config the following settings are particularly important:</p><pre><code class="language-YAML hljs">initial_condition: &quot;GCM&quot;
external_forcing: &quot;GCM&quot;
external_forcing_file: artifact&quot;cfsite_gcm_forcing&quot;/HadGEM2-A_amip.2004-2008.07.nc
cfsite_number : &quot;site23&quot;
surface_setup: &quot;GCM&quot;</code></pre><p>Here we must set all of <code>initial_condition</code>, <code>external_forcing</code> and <code>surface_setup</code> to be <code>GCM</code> as each component requires information from the external file. The <code>external_forcing_file</code> and <code>cfsite_number</code> together determine the temperature, specific humidity, and wind as well as horizontal and vertical advection profiles that drive the simulation, and can be set to a local file path as opposed to using the artifact. Radiation and surface temperature are also specified. Here the forcing file, an example of which is stored in the artifact, contains groups for each <code>cfsite</code> to drive the simulation. See <a href="https://agupubs.onlinelibrary.wiley.com/doi/full/10.1029/2021MS002631">Shen et al. 2022</a> for more information.</p><h3 id="Reanalysis-Driven-Case"><a class="docs-heading-anchor" href="#Reanalysis-Driven-Case">Reanalysis-Driven Case</a><a id="Reanalysis-Driven-Case-1"></a><a class="docs-heading-anchor-permalink" href="#Reanalysis-Driven-Case" title="Permalink"></a></h3><h4 id="Matched-ERA5-Trajectory"><a class="docs-heading-anchor" href="#Matched-ERA5-Trajectory">Matched ERA5 Trajectory</a><a id="Matched-ERA5-Trajectory-1"></a><a class="docs-heading-anchor-permalink" href="#Matched-ERA5-Trajectory" title="Permalink"></a></h4><p>The <code>ReanalysisTimeVarying</code> case extends the <code>GCM</code> driven case by providing support for single-column simulations which resolve the diurnal cycle, can be run at any site globally, and uses reanalysis to drive the simulation, allowing for calibration of EDMF to earth-system observations in the single-column setting. This feature was found to be needed to address biases in calibration arising from correlation between time-of-day and cloud liquid water path over the tropical Pacific. For this simulation we again highlight similar arguments in the config file:</p><pre><code class="language-YAML hljs">initial_condition: &quot;ReanalysisTimeVarying&quot;
external_forcing: &quot;ReanalysisTimeVarying&quot;
surface_setup: &quot;ReanalysisTimeVarying&quot;
surface_temperature: &quot;ReanalysisTimeVarying&quot;
start_date: &quot;20070701&quot;
site_latitude: 17.0
site_longitude: -149.0</code></pre><p>By this point, the first 4 entries are intuitive. We need to dispatch over each of these methods to setup the forcing for each component of the model. To obtain the observations, now note that instead of directly specifying a file we must specify a <code>start_date</code>, <code>site_latitude</code>, and <code>site_longitude</code>. This is because we now use <code>ClimaArtifacts.jl</code> to store data to ensure reproducibility of our simulation and results. <code>start_date</code> should be in in YYYMMDD format, <code>site_latitude</code> should be in degrees between -90 and 90, and <code>site_longitude</code> should be between -180 and 180. </p><div class="admonition is-info" id="Note-431fce19ff7264f8"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-431fce19ff7264f8" title="Permalink"></a></header><div class="admonition-body"><p>Depending on the amount of smoothing and data resolution, points near the boundaries will throw index errors. With default settings, users should stay at least 5 points away from the poles (1° for ERA5 data) for smoothing (4 points) and gradients (one extra point).</p></div></div><p>The data is generated by downloading from ECMWF and further documentation for ERA5 data download can be found either directly on the ECMWF page and <code>ClimaArtifacts.jl</code>. Note that the profiles, surface temperature, and surface fluxes cannot be obtained from a single request and so together we need 3 files for all the data. We include a script at <code>src/utils/era5_observations_to_forcing_file.jl</code> which extracts the profiles and computes the tendencies needed for the simulation from the raw ERA5 reanalysis files. We store the observations directly into an artifact <code>era5_hourly_atmos_processed</code> to eliminate the need to reprocess specific sites and locations. This setup means that users are free to choose sites globally at any time at which ERA5 data is available. Unfortunately, global hourly renanalysis is too large to store in an artifact and so we have currently only provided support for the first 5 days of July 2007 in the tropical Pacific, stored in <code>era5_hourly_atmos_raw</code>, only available on the <code>clima</code> and Caltech <code>HPC</code> servers. The test case can be run using: </p><pre><code class="language-bash hljs">julia --project=.buildkite .buildkite/ci_driver.jl --config_file config/model_configs/prognostic_edmfx_tv_era5driven_column.yml --job_id era5driven</code></pre><h4 id="Monthly-Averaged-Forcing"><a class="docs-heading-anchor" href="#Monthly-Averaged-Forcing">Monthly Averaged Forcing</a><a id="Monthly-Averaged-Forcing-1"></a><a class="docs-heading-anchor-permalink" href="#Monthly-Averaged-Forcing" title="Permalink"></a></h4><p>As the matched ERA5 trajectory is data intensive, requiring downloads for each day, we have also implemented an external forcing dispatch to repeat a specific day of data indefinitely. This setup is ideal for use with monthly averaged ERA5 data by hour of day and can be used to calibrate to monthly statistics. The setup is similar, except we change the flag for <code>external_forcing</code> to indicate that we want to repeat data: </p><pre><code class="language-YAML hljs">initial_condition: &quot;ReanalysisTimeVarying&quot;
external_forcing: &quot;ReanalysisMonthlyAveragedDiurnal&quot;
surface_setup: &quot;ReanalysisTimeVarying&quot;
surface_temperature: &quot;ReanalysisTimeVarying&quot;
start_date: &quot;20070701&quot;
site_latitude: 17.0
site_longitude: -149.0</code></pre><pre><code class="language-bash hljs">julia --project=.buildkite .buildkite/ci_driver.jl --config_file config/model_configs/prognostic_edmfx_diurnal_scm_imp.yml --job_id bomex</code></pre><h4 id="Running-the-Reanalysis-driven-cases-at-different-times-and-locations"><a class="docs-heading-anchor" href="#Running-the-Reanalysis-driven-cases-at-different-times-and-locations">Running the Reanalysis-driven cases at different times and locations</a><a id="Running-the-Reanalysis-driven-cases-at-different-times-and-locations-1"></a><a class="docs-heading-anchor-permalink" href="#Running-the-Reanalysis-driven-cases-at-different-times-and-locations" title="Permalink"></a></h4><p>You need 3 separate files with specific variables and naming convention for the data processing script to work.</p><ol><li>Hourly profiles with variables, following ERA5 naming convention, including <code>t</code>, <code>q</code>, <code>u</code>, <code>v</code>, <code>w</code>, <code>z</code>, <code>clwc</code>, <code>ciwc</code>. This file should be stored in the appropriate artifacts directory, named <code>&quot;forcing_and_cloud_hourly_profiles_$(start_date).nc&quot;</code> for <code>ReanalysisTimeVarying</code> and <code>monthly_diurnal_profiles_$start_date).nc</code> for <code>ReanalysisMonthlyAveragedDiurnal</code> where <code>start_date</code> should specify the date data starts on formatted YYYYMMDD. We require <code>clwc</code> and <code>ciwc</code> profiles because these are typical targets for calibration but are not needed to run the simulation directly.</li><li>Instantaneous variables, including surface temperature <code>ts</code> which should be stored in <code>&quot;hourly_inst_$(start_date).nc&quot;</code> for <code>ReanalysisTimeVarying</code> and <code>monthly_diurnal_inst</code> for <code>ReanalysisMonthlyAveragedDiurnal</code>.</li><li>Accumulated variables, including surface sensible and latent heat fluxes, <code>hfls</code> and <code>hfss</code>, which should be stored in <code>&quot;hourly_accum_$(start_date).nc&quot;</code> for <code>ReanalysisTimeVarying</code> and <code>monthly_diurnal_accum</code> for <code>ReanalysisMonthlyAveragedDiurnal</code>. These need to be divided by the appropriate time resolution, which for hourly data is 3600 and for daily and monthly data is 86400 (not a typo see <a href="https://confluence.ecmwf.int/display/CKB/ERA5%3A+data+documentation#ERA5:datadocumentation-Monthlymeans">here</a>).</li></ol><h5 id="On-HPC/Clima"><a class="docs-heading-anchor" href="#On-HPC/Clima">On HPC/Clima</a><a id="On-HPC/Clima-1"></a><a class="docs-heading-anchor-permalink" href="#On-HPC/Clima" title="Permalink"></a></h5><p>To run locations already in the artifact, e.g., sites in the tropical Pacific in the first 5 days of July 2007 the config file will work out of the box. To run other locations or times please follow the steps for local.</p><h5 id="On-local"><a class="docs-heading-anchor" href="#On-local">On local</a><a id="On-local-1"></a><a class="docs-heading-anchor-permalink" href="#On-local" title="Permalink"></a></h5><p>To run the simulation on a local machine you will need to first download the reanalysis data from ECMWF, ensuring that you have all the required variables. This will be stored in 3 separate files which should be all placed in the same directory. The user edit <code>.julia/artifacts/Overrides.toml</code> to point the <code>era5_hourly_atmos_raw</code> artifact point to the folder where the data is stored. For the raw data and location for processed files you&#39;ll need to specify the path where the data is stored and where to store the files as follows:</p><pre><code class="language-bash hljs">8234def2ead82e385a330a48ed2f0c030e434065 = &quot;/some/random/path/raw_data_dir&quot; # for raw data
a1a465e8d237d78bef1e6d346054da395787a9f9 = &quot;/some/random/path/processed_files&quot; # for storing</code></pre><p>Good luck! :wink:</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../radiative_equilibrium/">« Radiative Equilibrium</a><a class="docs-footer-nextpage" href="../restarts/">Restarts and checkpoints »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.0 on <span class="colophon-date" title="Thursday 20 November 2025 17:47">Thursday 20 November 2025</span>. Using Julia version 1.11.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
